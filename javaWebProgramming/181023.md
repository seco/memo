* query메소드
* 컨트롤러, 서비스, 다오를 연결해서 사용
* 브라우저가 있음. /boards?page=1 
* dispatcherservlet이 요청을 받음. 
* BoardController
* 파라미터를 연결받을 때 list(@requestParam)
* DTO는 레이어를 넘나드는 객체
* VO는 단순히 값을 가지는 객체 
* 수정하기도 해보기(조원들과)



스프링 MVC

* web.xml 

  * webApplicationContext

    * 스프링 컨테이너 
    * 스프링으로 웹 개발을 할때는 ApplicationContext를 직접 생성하지 않는다.
    * JavaConfig 또는 xmlConfig를 읽어들인다.
      * Service, DAO 관련 설정(웹 관련 설정은 없다.)
    * 부모 ApplicationContext

  * DispatcherServlet

    * 모든 요청을 받아들여서 대신 일을 해주는 객체
    * 내부적으로 WebApplicationContext를 포함하고있다. (자식 ApplicationContext)
      * Web 관련 설정이 있다.(Jsp, Controller ..)
    * 설정파일을 읽어들이게 만들어준다.(JavaConfig, XMLConfig)
    * DS의 ApplicationContext는 web.xml의 webApplicationContext를 부모로서 가진다.



설정에 따라서 접근하는 영역이 달라질 수 있다. UI와 Business Logic 부분을 분리해서 Bean으로 처리해주기 위함.



서블릿3.0 이상에서는 JavaConfig WAS 설정. 

web.xml은 WAS가 읽어들이는 설정 파일. 스프링이랑은 다르다. 

web.xml은 배포기술자라고 한다. 

리스너 : 와스가 처음 시작될 때 리스너 객체가 초기화되고, 이 안에 applicationContext를 가지고 있다. 

이 부분은 서블릿 기술 중 리스너가 뭔지 찾아봐도 된다. (이렇게 디테일하게 공부하지 않아도 된다.)



부모에서 WebApplicationContext에 등록하면 모두 사용할 수 있지만, 자식 WebApplicationContext에서 등록하면 웹관련 설정만 할 수 있다.



WAS에 / 요청을 처리해주는 애가 미리 있다. 디폴트 서블릿. 이미지도 보여주고, css도 보여주는 애다. 

mvc에서 / 요청을 바꿔버리면 이미지, css를 사용할 수 없다. 

모든 요청을 디스패처서블릿이 받는다. 원하는 요청이 없으면 디폴트 서블릿에 넘겨준다.

그런 설정을 만들어준다.



1. 기존 daoexam을 web프로젝트로 변경.
   1. <packaging>jar</packageing>을 <packaging>war</packageing>로 변경.
2. 웹 어플리케이션과 관련된 폴더를 생성
   1. src/main/webapp/WEB-INF 폴더 생성
   2. src/main/webapp/WEB-INF/views





---



| 1. 기존 daoexam을 web 프로젝트로 변경.                       |
| ------------------------------------------------------------ |
|                                                              |
| <packaging>jar</packaging> 를                                |
| <packaging>war</packaging> 로 변경                           |
|                                                              |
| 다음을 추가한다.                                             |
|                                                              |
| <dependency>                                                 |
| <groupId>org.springframework</groupId>                       |
| <artifactId>spring-webmvc</artifactId>                       |
| <version>${spring.version}</version>                         |
| </dependency>                                                |
|                                                              |
| <!-- Servlet JSP JSTL -->                                    |
| <dependency>                                                 |
| <groupId>javax.servlet</groupId>                             |
| <artifactId>javax.servlet-api</artifactId>                   |
| <version>3.1.0</version>                                     |
| <scope>provided</scope>                                      |
| </dependency>                                                |
|                                                              |
| <dependency>                                                 |
| <groupId>javax.servlet.jsp</groupId>                         |
| <artifactId>javax.servlet.jsp-api</artifactId>               |
| <version>2.3.1</version>                                     |
| <scope>provided</scope>                                      |
| </dependency>                                                |
|                                                              |
| <!-- jsp는 결과를 출력 JSTL & EL(WAS에 있다.) -->            |
| <dependency>                                                 |
| <groupId>jstl</groupId>                                      |
| <artifactId>jstl</artifactId>                                |
| <version>1.2</version>                                       |
| </dependency>                                                |
|                                                              |
| 메이븐으로 바로 실행하도록 하려면.                           |
|                                                              |
| <!-- maven에서 tomcat을 실행한다. -->                        |
| <plugin>                                                     |
| <groupId>org.apache.tomcat.maven</groupId>                   |
| <artifactId>tomcat7-maven-plugin</artifactId>                |
| <version>2.1</version>                                       |
| <configuration>                                              |
| <charset>UTF-8</charset>                                     |
| <uriEncoding>UTF-8</uriEncoding>                             |
| <port>8080</port>                                            |
| <path>/</path>                                               |
| </configuration>                                             |
| </plugin>                                                    |
|                                                              |
| 2. 웹 어플리케이션과 관련된 폴더를 생성                      |
|                                                              |
| src/main/webapp                                              |
| src/main/webapp/WEB-INF                                      |
| src/main/webapp/WEB-INF/views  : jsp가 저장되는 폴더         |
|                                                              |
| 3. 웹 어플리케이션 설정파일도 작성                           |
|                                                              |
| src/main/webapp/WEB-INF/web.xml                              |
|                                                              |
| web.xml파일에서는 2개의 설정파일을 읽어들인다.               |
|                                                              |
| ApplicationConfig.class(부모설정) : 비지니스 관련된 Bean     |
| WebMvcContextConfiguration.class : 웹과 관련된 Bean          |
|                                                              |
| 4. 	ApplicationConfig.class                               |
|                                                              |
| 기존 dao, service사용하는 설정                               |
|                                                              |
| 5. 	WebMvcContextConfiguration.class                      |
|                                                              |
| - WebMvcConfigurerAdapter 를 상속받아서 만든다.              |
| - Spring 5, Spring Boot 2에서는 WebMvcConfigurer인터페이스를 구현해서 작성한다. |
| - WebMvcConfigurerAdapter나 WebMvcConfigurer가 가지고 있는 메소드를 오버라이딩해서, |
| Web과 관련된 설정을 하게 된다.                               |
|                                                              |
|                                                              |
| @Configuration // Java Config                                |
| @EnableWebMvc // 자동으로 Spring MVC에대한 설정              |
| @ComponentScan(basePackages = { "examples.daoexam.controller"}) |
| public class WebMvcContextConfiguration extends WebMvcConfigurerAdapter { |
| // 필요한 기능이 있다면 Bean을 생성하거나 메소드를 오버라이딩하여 설정 |
| }                                                            |
|                                                              |
|                                                              |
| // 정적 데이터를 외부에 어떤 path로 제공할 것이냐하는 설정을 한다. |
| // src/main/webapp/img/github.gif 가 있을 경우 아래와 같이 설정하면 |
| // <img src="/images/github.gif">                            |
|                                                              |
| @Override                                                    |
| public void addResourceHandlers(ResourceHandlerRegistry registry) { |
| registry.addResourceHandler("/assets/**").addResourceLocations("classpath:/META-INF/resources/webjars/").setCachePeriod(31556926); |
| registry.addResourceHandler("/css/**").addResourceLocations("/css/").setCachePeriod(31556926); |
| registry.addResourceHandler("/images/**").addResourceLocations("/img/").setCachePeriod(31556926); |
| registry.addResourceHandler("/js/**").addResourceLocations("/js/").setCachePeriod(31556926); |
| }                                                            |
|                                                              |
| //    / 요청은 WAS가 가지고 있는 DefaultServlet이 처리한다.  |
| //    Dispatcher서블릿이 Controller 를 호출해서 url을 처리하는데 요청받은 url을 처리할 Controller가 없으면 |
| //    DefaultServlet에게 해당 url을 처리해달라고 요청한다.   |
| @Override                                                    |
| public void configureDefaultServletHandling(DefaultServletHandlerConfigurer configurer) { |
| configurer.enable();                                         |
| }                                                            |
|                                                              |
|                                                              |
| // ViewResolver를 설정.                                      |
| // InternalResourceViewResolver 는 ViewResolver중에 한가진데 어떤 JSP를 사용할지 전략을 세워준다. |
| // 사용자가 Controller에서 view name(ex : "list")을 리턴하면, Dispatcher서블릿은 |
| // ViewResolver에게 해당 view name을 통하여 어떤 View를 사용할지 물어보게 되어 있다. |
| // "/WEB-INF/views/" + view name + ".jsp" 라는 경로의 jsp를 사용하도록 하겠다. 결정을 한다. |
| // 해당 정보를 이용하여 JstlView라는 객체를 생성하여 jsp를 보여주게 된다. |
| @Bean                                                        |
| public InternalResourceViewResolver getInternalResourceViewResolver() { |
| InternalResourceViewResolver resolver = new InternalResourceViewResolver(); |
| resolver.setPrefix("/WEB-INF/views/");                       |
| resolver.setSuffix(".jsp");                                  |
| return resolver;                                             |
| }                                                            |



MainController

@RequestMapping("/")

public String main() {

​	return "index"; // view name이 

}



맨 처음부터 한번 만들어보자.!!!

녹화프로그램으로 만들면서 해보자. 같이 이야기하면서 해보자. 