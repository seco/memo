1106



스프링 코어(DI, AOP)

게시판 

댓글, 답글 게시판은 웹에서 사용하는 대부분의 기술이 사용됩니다. 

어떻게해야 효율적으로 프로그래밍 할 수 있을까? 고민하면서 

책에 있는 소스와 깃허브에 있는 소스는 시행착오가 없다. 미처 생각하지 못한 것 때문에 리팩토링하는 과정이 프로그래밍을 잘해나가는 과정이다. 프로젝트를 꾸준히해야 실력이 향상된다. 

배포까지 시도해보자. (다음주에 확인) 



어플리케이션 컨텍스트가 언제 생성이 되는가? - 

web.xml 

두 가지 파일을 읽어들인다. 

1. 리스너 설정에서 자바config를 읽어들이면서 ApplicationContext가 설정된다. 
   1. 리스너 설정할 때 컨텍스트 파라미터로 자바config를 지정해줬다. 

두 가지 설정이 있다. 

디스패쳐 서블릿, 컨텍스트 로더 리스너

둘 다 스프링이 제공해주는 클래스다. 

얘네들이 기본으로 xml 파일을 읽어들이는데 기본으로 자바config를 읽어들일 수 있도록 하는 객체를 지정해준 것.



내부적으로 스프링 설정파일을 읽어들이는 것은 applicationContext이다. 



어플리케이션 컨텍스트 간에는 부모 자식 관계가 있다고 했다. 디스패쳐 서블릿은 웹과 관련된 설정을 읽어들인다. 

웹에서 컨트롤러를 사용한다. 

컨트롤러에서는 서비스를 사용할 수 있다. 서비스에서는 컨트롤러를 사용할 수 없다. 

컨텍스트로더리스너가 부모이고, 디스패처 서블릿이 자식이다. 



어플리케이션 컨텍스트가 여러개가 있다. 자식은 부모쪽에 있는 것을 사용할 수 있다. 

디스패쳐서블릿은 여러개가 설정될 수 있다. 

나중에 서버를 분리할 경우 

```xml
<servlet-mapping>
    <servlet-name>mvc</servlet-name>
    <url-pattern>/</url-pattern>
    <url-pattern>/board</url-pattern>
    <url-pattern>/#</url-pattern>
    ...
</servlet-mapping>
```



디스패쳐 서블릿 등록 전에 / 를 등록해주는 것.

WAS는 기본적으로 디폴트 서블릿을 가지고 있다. 

디폴트 서블릿은 이미지 처리, 정적인 처리를 한다. 기본적인 일을 해준다. / 에 대한 처리를 해준다. 모든 경로에 대한 처리.



컨트롤러에 대한 정보를 핸들러 매핑 정보라고 한다. 이 정보를 디스패쳐서블릿이 가지고 있다. 컨트롤러를 빈으로 등록한다. 빈이 가지고 있는 RequestMapping 정보를 읽어들인다. 

갯매핑, 포스트 매핑 등등이 리퀘스트 매핑을 내부적으로 포함해준다. 

web.xml 파일에 보면 위에 설명한 설정들이 있다. 

스프링에서 가장 중요한 객체가 누구냐? 컨테이너! 빈컨테이너, DI컨테이너 

컨테이너가 메모리에 빈을 등록한다. 이것이 코어다. 스프링을 설정하면 어느시점에서 빈이 생성되는지 명확하게 알아야한다. 빈컨테이너, 빈팩토리, 어플리케이션컨텍스트, DI컨테이너 등등이 모두 같은 말이다. 



---



web.xml 파일을 자바config로 바꿀 수 있다. 

웹 어플리케이션의 종류 129page

1. 화면으로 응답한다.(브라우저 화면)
2. 데이터로 응답한다.



REST API 르아줘가 서버에서 데이터를 주고받는 것. JSON을 많이 주고 받는다. 

회원정보를 DB에서 읽어왔지만 다른 서버에서 요청할 수 있다. 



서비스, 다오 가 모델

jsp가 뷰



웹은 보통 mvc 라는 개념으로 사용.



컨트롤러가 일반 자바 클래스 -> POJO

컨트롤러 메소드 : 리퀘스트 파람.



한 서블릿이 URL을 하나 처리한다. 

게시판을 보면 url 갯수만큼 서블릿을 만들어야한다.



spring mvc를 비슷한 기능을 모아놨다. 



추상화 높은 차원으로 추상화한다. 편의성도 높이고 조금 더 나은 방법을 사용한다.



국제화 관련 : 날짜, 시간, 문자열 



컨트롤러, 뷰, 서비스, 레포지토리(다오) 부분이 우리가 만들어야하는 부분이다. 



뷰리졸버는 전략 객체이다. 

 : 뷰 이름으로 어떤 뷰를 생성할 지 결정해준다. 

 : 뷰리졸버는 여러개 등록될 수 있다. 

 : accept 정보도 간다. 뷰 네임, 모델맵으로 넘어온 정보도 있다.



accept : 원하는 정보를 헤더정보에 담아서 보내는 것.

 기본은 html 데이터이다. 

json 데이터나 xml 데이터를 요청할 수도 있다. 

받아온 정보를 바탕으로 사용자에게 원하는 정보를 보여준다. 



jsp를 사용하면 jstl 뷰라는 객체가 jsp 파일로 포워딩해서 보여준다. 



web.xml, ServletContainerInitializer 는 와스 설정

위의 것들을 WebApplicationInitializer 스프링에서 구현해준다.  

web.xml은 javaConfig가 아니기 때문에 익숙하지 않은 사람이 볼때는 어색할 수 있다. 



어노테이션 정보를 찾을 때 핸들러 매핑 정보를 읽어오면 된다. 



핸들러 > 컨트롤러.



플래시맵복원과 관련된 것은 리다이렉트. 플래시맵은 일회성(단발성)이다. 내부적으로 세션에 저장됨.

새로고침 했을 경우 



키워드를 아는 것이 중요하다. 

Body부분이 멀티파트로 넘어올 때 



프로그램을 짤 때 경계를 알아야한다. (최대값, 최소값..)

한 사이트 당 저장할 수 있는 쿠키의 갯수

세션은 메모리에 저장되니 메모리의 한도만큼. 

파일 저장 시 한 디렉토리에 저장할 수 있는 파일의 갯수

폴더별로 만들어서 파일에 저장.

디스크가 풀이난다면?



어느 시점까지는 버틸 수 있겠다는 생각이 들어야 뒷일을 준비한다.





dispatureServlet과 Controller 사이에 실행되는 객체가 있다. intersepter, agumentResolver

실행되는 순서를 결정해주는 것이 HandlerExcetutionChain이다. 

인터셉터는 여러개가 있을 수 있다. 



앞으로 공부할 주제

* ThreadLocal : 자바에 있는 객체. 하나의 쓰레드가 유지되는 동안 정보를 유지할 수 있다. 
  * WAS는 자바로 만들어진 것. 요청받고 응답할 때까지가 한 쓰레드이다. 
  * 한 싸이클 안에서만 사용할 수 있다.



@PathVariable

@RequestParam

@RequestHeader

@BeanValidation 값을 검증하기 위한. 

Binding Result라는 값으로 검색해보자. 

Binding Result Spring mvc

javax -> 표준 에너테이션 : 이를 구현하는 것은 하이버네이트 벨리데이션.



타임리프라는 문법. 

요즘은 회원가입, 글쓰기에서 ajax를 많이 호출한다. 



입력값 검사.

자바스크립트로만 값을 검증할 수 없다.  

입력을 받으면 입력이 잘되었는지 확인하고 그 이후에 사용하는 것을 먼저 생각하자.



설명한 것을 정리하고 : 

SpringMVC의 핵심.



스프링부트, JPA를 이용해서 지금 만든 게시판을 고치는 것.



프로젝트를 하는사람과 안하는 사람. 

같은 주제를 하는 사람끼리 모이는 것이 좋다. 

만들고 싶은 프로젝트 . 

운영할 수 있는 사이트 . 